---
import BaseLayout from "../../../../layouts/BaseLayout.astro";
import { withBasePath } from "../../../../lib/base-path";
import { getFeatureGroups } from "../../../../lib/spec-data";

const groups = await getFeatureGroups();
const toc = groups.map((g) => ({ id: g.kind, title: g.kind }));
const totalCommands = groups.reduce((sum, g) => sum + g.apis.filter((a) => Boolean(a.ugoite_cli?.command)).length, 0);
---

<BaseLayout title="CLI Commands | Ugoite" description="CLI command catalog grouped by feature domain." toc={toc}
  related={[{ href: "/app/cli", label: "CLI Overview" }]}>

  <section class="doc-card-hero">
    <div style="position: relative; z-index: 1;">
      <span class="doc-pill">CLI Commands</span>
      <h1 style="font-size: 2rem; font-weight: 800; margin-top: 0.75rem; letter-spacing: -0.02em;">Command Catalog</h1>
      <p style="color: var(--doc-muted); margin-top: 0.5rem; line-height: 1.6;">
        {totalCommands} commands across {groups.length} domains. Select a domain for terminal-style documentation with copy buttons.
      </p>
    </div>
  </section>

  <div class="doc-grid">
    {groups.map((group) => {
      const cmdCount = group.apis.filter((a) => Boolean(a.ugoite_cli?.command)).length;
      return (
        <a href={withBasePath(`/app/cli/commands/${group.kind}`)} id={group.kind} class="doc-card doc-card-hover" style="text-decoration: none; color: inherit;">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
            <span class="doc-pill">{group.kind}</span>
            <span style="font-size: 0.75rem; color: var(--doc-muted);">{cmdCount} commands</span>
          </div>
          <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
            {group.apis.filter((a) => Boolean(a.ugoite_cli?.command)).map((api) => (
              <code style="font-size: 0.6875rem; background: var(--doc-bg-subtle); padding: 0.125rem 0.375rem; border-radius: var(--doc-radius-sm);">{api.ugoite_cli?.command}</code>
            ))}
          </div>
        </a>
      );
    })}
  </div>
</BaseLayout>
