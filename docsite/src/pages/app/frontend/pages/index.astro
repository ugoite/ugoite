---
import BaseLayout from "../../../../layouts/BaseLayout.astro";
import { getUiPages } from "../../../../lib/spec-data";

const pages = await getUiPages();
const toc = pages.map((page) => ({ id: page.id, title: page.title }));
---

<BaseLayout title="Frontend Page Catalog | Ugoite Docsite" description="UI page specs parsed from docs/spec/ui/pages." toc={toc}>
  <section class="doc-card doc-card-hero">
    <span class="doc-pill">docs/spec/ui/pages</span>
    <h1 class="mt-3 text-3xl font-bold">ページ一覧（複数ページ展開）</h1>
    <p class="mt-2 text-sm" style="color: var(--doc-muted);">
      UI 仕様 YAML からページ定義を読み込み、`mise run e2e` で生成されるスクリーンショットの参照パスも併記します。
    </p>
  </section>

  {pages.map((page) => {
    const screenshotPath = `/e2e/test-results/ui-pages/${page.id}.png`;
    return (
      <section id={page.id} class="doc-card">
        <div class="flex flex-wrap items-center justify-between gap-3">
          <div>
            <p class="doc-pill">{page.id}</p>
            <h2 class="mt-2 text-xl font-semibold">{page.title}</h2>
          </div>
          <span class="rounded-full border px-3 py-1 text-xs" style="border-color: var(--doc-border); color: var(--doc-muted);">{page.implementation ?? "unknown"}</span>
        </div>
        <div class="mt-3 overflow-x-auto">
          <table class="doc-table text-sm">
            <thead>
              <tr>
                <th>Route</th>
                <th>Spec source</th>
                <th>E2E screenshot reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>{page.route}</td>
                <td><a href={`/docs/spec/ui/pages/${page.fileName.replace(/\.yaml$/, "")}`}>{page.fileName}</a></td>
                <td>{screenshotPath}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    );
  })}
</BaseLayout>
