---
import themes from "../../../shared/themes/ui-theme-definitions.json";
---

<div class="flex items-center gap-2">
  <select id="theme" class="doc-console-input" style="width: auto; padding: 0.25rem 0.5rem; font-size: 0.75rem;" data-theme-selector>
    {themes.map((theme) => <option value={theme.id}>{theme.label}</option>)}
  </select>
  <select id="mode" class="doc-console-input" style="width: auto; padding: 0.25rem 0.5rem; font-size: 0.75rem;" data-mode-selector>
    <option value="light">Light</option>
    <option value="dark">Dark</option>
  </select>
</div>

<script>
  const themeKey = "ugoite-ui-theme";
  const modeKey = "ugoite-color-mode";
  const root = document.documentElement;
  const themeSelect = document.querySelector("[data-theme-selector]");
  const modeSelect = document.querySelector("[data-mode-selector]");

  const applyThemeAndMode = () => {
    const theme =
      themeSelect instanceof HTMLSelectElement ? themeSelect.value : localStorage.getItem(themeKey) || "materialize";
    const mode =
      modeSelect instanceof HTMLSelectElement ? modeSelect.value : localStorage.getItem(modeKey) || "light";

    root.dataset.uiTheme = theme;
    root.dataset.colorMode = mode;
    localStorage.setItem(themeKey, theme);
    localStorage.setItem(modeKey, mode);
  };

  const initialTheme = localStorage.getItem(themeKey) || "materialize";
  const initialMode = localStorage.getItem(modeKey) || "light";

  if (themeSelect instanceof HTMLSelectElement) {
    themeSelect.value = initialTheme;
    themeSelect.addEventListener("change", applyThemeAndMode);
  }

  if (modeSelect instanceof HTMLSelectElement) {
    modeSelect.value = initialMode;
    modeSelect.addEventListener("change", applyThemeAndMode);
  }

  applyThemeAndMode();
</script>
